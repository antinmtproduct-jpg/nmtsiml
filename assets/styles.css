/* AntiSchool Exam — BRAND THEME (CSS only, no HTML changes)
   Палета, типографіка й компоненти узгоджені з брендбуком AntiSchool. */

/* ---------------- FONTS ---------------- */
@import url("https://fonts.googleapis.com/css2?family=Commissioner:wght@400;500;600;700&display=swap");

/* ---------------- TOKENS ---------------- */
:root{
  /* Colors — from brand kit */
  --bg: #F6F7FC;          /* light background (Cellar Fog) */
  --surface: #FFFFFF;     /* plain card surface */
  --surface-alt: #EDE7FF; /* soft lavender surface */
  --stroke: #E6E8F4;      /* light stroke */

  --text: #1E2240;        /* main text on light backgrounds */
  --muted: #6B7193;       /* secondary text */

  --primary: #1D19B4;     /* brand primary */
  --primary-10: rgba(29,25,180,.10);
  --primary-15: rgba(29,25,180,.15);
  --primary-20: rgba(29,25,180,.20);
  --primary-30: rgba(29,25,180,.30);
  --primary-40: rgba(29,25,180,.40);

  --accent-orange: #EE8602; /* warm accent */
  --accent-yellow: #F6B801; /* secondary accent */

  --ok: #18C28A;
  --bad: #E84F5A;

  /* Shadows & radius (Practice page visual language) */
  --radius-lg: 18px;
  --radius-md: 12px;
  --radius-sm: 10px;
  --shadow-1: 0 6px 28px rgba(24, 31, 56, .10);
  --shadow-2: 0 10px 36px rgba(24, 31, 56, .12);

  /* Container */
  --container: 1080px;
}

/* Optional dark scheme (kept subtle) */
@media (prefers-color-scheme: dark){
  :root{
    --bg: #0E1022;
    --surface: #141730;
    --surface-alt: #1A1E3F;
    --stroke: #2A2E54;

    --text: #E9EBFF;
    --muted: #A5AAD6;

    --ok: #2ED2A0;
    --bad: #FF6B7A;
  }
}

/* ---------------- BASE ---------------- */
*{ box-sizing: border-box; }
html,body{ height: 100%; }
body{
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: "Commissioner", system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans";
  font-weight: 400;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.container{
  width: 100%;
  max-width: var(--container);
  margin: 0 auto;
  padding: 0 20px;
}

/* ---------------- TYPOGRAPHY (from brand spec H1–H4, B1–B5) ---------------- */
.h1, h1{ font-size: clamp(34px, 4vw, 52px); font-weight: 600; line-height: 1.15; letter-spacing: .2px; }
.h2, h2{ font-size: clamp(28px, 3.3vw, 40px); font-weight: 600; line-height: 1.2; }
.h3, h3{ font-size: clamp(22px, 2.2vw, 28px); font-weight: 500; line-height: 1.25; }
.h4, h4{ font-size: clamp(20px, 2vw, 24px);  font-weight: 600; line-height: 1.3; }

p, .b5{ font-size: 16px; line-height: 1.55; }
.b4{ font-size: 18px; line-height: 1.5; font-weight: 500; }
.b3{ font-size: 20px; line-height: 1.5; font-weight: 500; font-style: italic; }
.b2{ font-size: 20px; line-height: 1.5; font-weight: 500; }
.b1{ font-size: 20px; line-height: 1.5; font-weight: 600; }
.lead{ color: var(--muted); }

/* Links */
a { color: var(--primary); text-decoration: none; }
a:hover { text-decoration: underline; }

/* MathJax inline tweaks (keeps formula baseline nice) */
mjx-container[jax="SVG"]{ margin: 0 .04em; }

/* ---------------- HEADER (home) ---------------- */
.site-header{
  position: sticky; top:0; z-index: 10;
  background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.65));
  backdrop-filter: blur(6px);
  border-bottom: 1px solid var(--stroke);
}
.site-header .container{
  display:flex; align-items:center; justify-content:space-between;
  padding: 14px 20px;
}
.brand{ display:flex; gap:12px; align-items:center; }
.logo{
  width:36px; height:36px; border-radius: 12px;
  display:grid; place-items:center; color:#fff; font-weight:700;
  background:
    radial-gradient(140% 140% at 30% 20%, #6C6AF7 0%, var(--primary) 55%, #0B0A6B 95%);
  box-shadow: var(--shadow-1);
}
.brand-text{ display:flex; flex-direction:column; line-height:1.1; }
.brand-text span{ color: var(--muted); font-size:12px; }

/* ---------------- HOME ---------------- */
.page-home .home-main{ padding: 32px 20px 60px; }
.subject-grid{
  display:grid;
  grid-template-columns: repeat(4, minmax(0,1fr));
  gap: 18px;
}
@media (max-width: 900px){ .subject-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
@media (max-width: 520px){ .subject-grid{ grid-template-columns: 1fr; } }

.subject-card{
  display:flex; flex-direction:column; align-items:flex-start;
  width:100%; padding:20px; border-radius: var(--radius-lg);
  border:1px solid var(--stroke);
  background: var(--surface);
  box-shadow: var(--shadow-1);
  cursor:pointer; text-align:left;
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease;
}
.subject-card:hover{
  transform: translateY(-2px);
  box-shadow: var(--shadow-2);
  border-color: var(--primary-30);
  background: linear-gradient(0deg, rgba(255,255,255,1) 0%, rgba(237,231,255,.45) 100%); /* matches brand gradient softness */
}
.subject-ico{
  font-weight: 800; font-size: 28px; line-height: 1;
  width:46px; height:46px; border-radius: 14px;
  display:grid; place-items:center; color:#fff; margin-bottom:10px;
  background:
    radial-gradient(140% 140% at 30% 20%, #6C6AF7 0%, var(--primary) 60%, #0B0A6B 100%);
}
.subject-title{ font-weight:700; margin-bottom:4px; }
.subject-desc{ color: var(--muted); font-size: 14px; }

/* Footer */
.site-footer{ padding: 28px 0 44px; color: var(--muted); }

/* ---------------- SIM HEADER ---------------- */
.app-header{
  position: sticky; top:0; z-index: 20;
  background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.7));
  backdrop-filter: blur(6px);
  border-bottom: 1px solid var(--stroke);
}
.header-row{
  display:flex; align-items:center; gap: 12px;
  padding: 10px 0;
}
.brand-min{
  display:inline-grid; place-items:center;
  width:36px; height:36px; border-radius: 12px;
  background: var(--surface);
  border:1px solid var(--stroke);
  color: var(--primary);
  text-decoration:none; font-weight:700;
}
.subject-badge{
  font-weight: 700;
  padding: 8px 12px; border-radius: 999px;
  background: var(--surface-alt); color: var(--text);
  border:1px solid var(--stroke);
}
.subject-badge[data-subject="math"]{ background: rgba(29,25,180,.08); }
.subject-badge[data-subject="ukr"]{ background: rgba(246,184,1,.15); }
.subject-badge[data-subject="eng"]{ background: rgba(238,134,2,.12); }
.subject-badge[data-subject="history"]{ background: rgba(109,112,245,.12); }

.header-info{
  margin-left:auto; display:flex; align-items:center; gap: 14px;
  font-variant-numeric: tabular-nums;
}
.counter{ color: var(--text); font-weight:600; }
.timer{ color: var(--muted); }
.saved{
  color: var(--ok); opacity:0; transform: translateY(-4px);
  transition: opacity .2s ease, transform .2s ease;
}
.saved.visible{ opacity:1; transform: translateY(0); }

.progress{ height: 6px; background: rgba(29,25,180,.10); }
.progress-bar{
  height:100%; width:0%;
  background: linear-gradient(90deg, var(--primary), #6C6AF7 120%);
  transition: width .2s ease;
  border-radius: 0 6px 6px 0;
}

/* ---------------- APP MAIN ---------------- */
.page-sim .app-main{ padding: 22px 20px 40px; }
.stage{ min-height: 180px; }

/* Card */
.q-card{
  background: var(--surface);
  border:1px solid var(--stroke);
  border-radius: var(--radius-lg);
  padding: 20px;
  box-shadow: var(--shadow-1);
}
.q-body{ font-size: 18px; line-height: 1.6; }
.q-body p{ margin: 0 0 12px; }
.q-body img{ max-width:100%; height:auto; border-radius: var(--radius-md); }

/* --- MCQ --- */
.q-list{ margin-top: 14px; display:flex; flex-direction:column; gap: 10px; }
.q-option{
  display:flex; align-items:center; gap: 10px;
  padding: 10px; border-radius: var(--radius-md);
  border:1px solid var(--stroke);
  background: var(--surface);
  transition: border-color .12s ease, transform .08s ease, background .12s ease;
}
.q-option:hover{ border-color: var(--primary-20); transform: translateY(-1px); }
.q-option input[type="radio"]{ accent-color: var(--primary); transform: scale(1.1); }
.q-option label{ display:flex; align-items:center; gap: 10px; width:100%; cursor:pointer; }
.opt-marker{
  width:30px; height:30px; border-radius:50%;
  display:grid; place-items:center;
  background: var(--primary-15);
  color: var(--primary); font-weight:700;
}
.opt-text{ line-height:1.45; }

/* --- MATCH (two columns + matrix) --- */
.match-two-cols{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  margin-top: 14px;
}
@media (max-width: 820px){ .match-two-cols{ grid-template-columns: 1fr; } }

.match-col{
  background: var(--surface);
  border: 1px dashed var(--stroke);
  border-radius: var(--radius-md);
  padding: 12px;
}
.match-col-title{
  font-weight: 800; font-size: 14px;
  color: var(--muted);
  margin-bottom: 8px;
}

.match-list,
.match-option-list{
  list-style: none;
  margin: 0; padding: 0;
  display: flex; flex-direction: column; gap: 8px;
}
.match-left-item, .match-option-item{
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 10px; align-items: start;
  padding: 8px; border-radius: var(--radius-md);
  border: 1px solid var(--stroke);
  background: var(--surface);
}
.badge-num, .badge-let{
  display: inline-grid; place-items: center;
  width: 28px; height: 28px; border-radius: var(--radius-sm);
  font-weight: 800;
  background: var(--primary-10); color: var(--primary);
}
.match-left-text, .match-option-text{ line-height: 1.45; }

/* Matrix */
.match-matrix-wrap{ margin-top: 16px; }
.matrix-title{ color: var(--muted); margin-bottom: 8px; }

.match-matrix{
  width: 100%;
  border-collapse: separate;
  border-spacing: 6px;
  table-layout: fixed;
}
.match-matrix th, .match-matrix td{ text-align: center; }
.match-matrix thead th{ font-weight: 800; font-size: 14px; color: var(--text); }
.match-matrix .stub{ width: 46px; }
.match-matrix .row-head{
  font-weight: 800; width: 46px;
  background: var(--surface);
  border:1px solid var(--stroke);
  border-radius: var(--radius-sm);
}
.match-matrix .cell{ position: relative; height: 42px; }
.match-matrix .cell-label{
  display: block; width: 100%; height: 100%;
  border: 1px solid var(--stroke);
  border-radius: var(--radius-md);
  background: var(--surface);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.6);
  cursor: pointer;
  transition: transform .08s ease, border-color .12s ease, background .12s ease;
}
.match-matrix .cell-label:hover{
  border-color: var(--primary-30);
  transform: translateY(-1px);
}
/* radio hidden but accessible */
.match-matrix input[type="radio"]{
  position: absolute; opacity: 0; inset: 0;
}
.match-matrix input[type="radio"]:checked + .cell-label{
  background: linear-gradient(180deg, var(--primary), #6C6AF7);
  border-color: transparent;
  color: #fff;
  box-shadow: var(--shadow-1);
}
/* keyboard focus */
.match-matrix input[type="radio"]:focus-visible + .cell-label{
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

/* --- SHORT ANSWER --- */
.sa-input{
  width:100%; margin-top: 14px;
  padding:12px 14px; border-radius: var(--radius-md);
  border:1px solid var(--stroke); background: var(--surface); color: var(--text);
}
.sa-input:focus{ outline: 2px solid var(--primary); outline-offset: 2px; }

/* ---------------- CONTROLS (Buttons) ---------------- */
.controls{
  display:flex; align-items:center; gap: 12px;
  margin-top: 16px;
}
.controls .gap{ flex:1; }
.btn{
  appearance:none; border:1px solid var(--stroke);
  background: var(--surface); color: var(--text);
  padding:10px 16px; border-radius: var(--radius-md); cursor:pointer;
  font-weight:700; box-shadow: var(--shadow-1);
  transition: transform .12s ease, border-color .12s ease, background .12s ease, box-shadow .12s ease;
}
.btn:hover{ transform: translateY(-1px); border-color: var(--primary-20); box-shadow: var(--shadow-2); }
.btn:disabled{ opacity:.6; cursor:not-allowed; transform:none; }
.btn-primary{
  color: #fff;
  border-color: transparent;
  background: linear-gradient(180deg, var(--primary), #6C6AF7 85%);
}
.btn-accent{
  color:#2A1A00;
  border-color: transparent;
  background: linear-gradient(180deg, var(--accent-yellow), #EEB400 85%);
}
.btn.link{
  background: transparent; border-color: transparent; padding: 8px 6px; color: var(--primary);
}

/* ---------------- RESULT ---------------- */
/* RESULT (prettier) */
.result{ margin-top: 22px; }
.result-card{
  background: var(--surface); border:1px solid var(--stroke); border-radius: var(--radius-lg);
  padding: 20px; box-shadow: var(--shadow-1);
}

.result-main{
  display:flex; align-items:center; gap: 20px; flex-wrap: wrap; margin-bottom: 6px;
}
.result-score .num{ font-size: clamp(42px, 8vw, 68px); font-weight: 900; line-height:.9; color: var(--primary); }
.result-score .denom{ color: var(--muted); margin-top: 4px; }
.result-text h2{ margin: 0 0 6px; font-size: 22px; font-weight: 700; }
.result-text p{ margin: 0 0 6px; color: var(--muted); }

/* ==== Unified disclosure chevrons for all result sections ==== */
.result-details summary{
  display:flex; align-items:center; gap:10px;
  cursor:pointer; padding:10px 0; margin-top:10px;
  font-weight:700; color: var(--text);
  list-style: none; /* Firefox */
}
.result-details summary::-webkit-details-marker{ display:none; } /* Chrome/Safari */

/* Draw a chevron via borders — однаково в усіх ОС/браузерах */
.result-details summary::before{
  content:"";
  display:inline-block;
  width:.55em; height:.55em;
  border-right:2px solid var(--primary);
  border-bottom:2px solid var(--primary);
  transform: rotate(-45deg);      /* ► */
  transition: transform .15s ease;
  margin-right: 2px;
}
.result-details[open] summary::before{
  transform: rotate(45deg);       /* ▼ */
}

/* (необов’язково) легкий акцент при наведенні */
.result-details summary:hover{ color: var(--primary); }
.result-details.pretty[open] summary::before{ transform: rotate(0deg); }

.table-wrap{ width:100%; overflow: auto; }
.score-table{
  width:100%; border-collapse: separate; border-spacing: 0 10px;
}
.score-table thead th{
  text-align:left; font-weight:800; font-size:14px; color: var(--muted);
  padding: 0 12px 6px 12px; position: sticky; top: 0; background: var(--surface);
}
.score-table tbody tr{
  background: var(--surface); border:1px solid var(--stroke);
  border-radius: var(--radius-md); box-shadow: var(--shadow-1);
}
.score-table tbody tr > *{
  padding:12px; vertical-align: middle;
}
.score-table .t-name{ min-width: 260px; }
.t-name .t-name-top{
  display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px;
}
.t-name .name{ font-weight:600; }
.badge-acc{
  display:inline-flex; align-items:center; justify-content:center; min-width:56px;
  padding:4px 8px; border-radius: 999px; font-weight:700; font-size:12px;
  color:#fff; background: var(--primary);
}
.meter{
  width:100%; height:8px; border-radius: 999px;
  background: rgba(29,25,180,.12); position: relative; overflow: hidden;
}
.meter > span{
  position:absolute; left:0; top:0; bottom:0; width:0%;
  background: linear-gradient(90deg, var(--primary), #6C6AF7 120%);
  border-radius: 999px; transition: width .4s ease;
}

/* number cells: make them pill-ish */
.score-table .t-num, .score-table .t-ok, .score-table .t-bad{
  width:110px; text-align:center; font-weight:700;
}
.score-table .t-ok{
  color:#063527; background: rgba(24,194,138,.15);
  border-left:1px solid var(--stroke); border-right:1px solid var(--stroke);
  border-radius: 10px;
}
.score-table .t-bad{
  color:#3a0b0f; background: rgba(232,79,90,.15);
  border-radius: 10px;
}

/* tiers by accuracy */
.score-table tbody tr.tier-good .badge-acc{ background: linear-gradient(180deg,#16a34a,#22c55e); }
.score-table tbody tr.tier-mid  .badge-acc{ background: linear-gradient(180deg,#f59e0b,#f6b801); color:#2a1a00; }
.score-table tbody tr.tier-low  .badge-acc{ background: linear-gradient(180deg,#ef4444,#e84f5a); }

/* explanations block */
.result-details:not(.pretty) summary{ cursor:pointer; padding: 8px 0; color: var(--text); font-weight:700; }
.explanations{ margin: 8px 0 0; padding-left: 20px; display:flex; flex-direction:column; gap:12px; }
.explanations li{
  background: var(--surface); border:1px solid var(--stroke); border-radius: var(--radius-md);
  padding: 12px;
}
.explanations li.ok{ border-color: rgba(24,194,138,.35); }
.explanations li.bad{ border-color: rgba(232,79,90,.40); }
.exp-head{ display:flex; align-items:center; gap: 8px; margin-bottom:6px; }
.pill{
  display:inline-flex; align-items:center; gap:6px;
  padding: 6px 10px; border-radius:999px; border:1px solid var(--stroke);
  font-size: 12px; font-weight:700;
}
.pill.ok{ color:#063527; background: rgba(24,194,138,.2); border-color: rgba(24,194,138,.35); }
.pill.bad{ color:#3a0b0f; background: rgba(232,79,90,.18); border-color: rgba(232,79,90,.35); }
.pill.type{ color: var(--muted); background: transparent; }

.result-actions{ margin-top: 14px; display:flex; gap: 10px; flex-wrap: wrap; }


/* ---------------- MISC ---------------- */
.hidden{ display:none !important; }
.noscript{
  margin: 14px; padding: 12px; border:1px solid var(--stroke);
  background: var(--surface); border-radius: var(--radius-md); color: var(--bad);
}

/* Focus ring for accessibility */
:where(button, a, input, select):focus-visible{
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}
/* === Results mode tweaks === */
body.results-mode .controls { display: none !important; }     /* ховаємо Назад/Далі */
body.results-mode .page-sim .app-main { padding-top: 10px; }  /* підтягуємо вгору */
.app-header .header-results { padding: 12px 0; }
.app-header .header-results .brand-text span { color: var(--muted); font-size: 12px; }

/* ===== Lead form hero (clean, tuned) ===== */
.lead-wrap{
  --bg1:#0d0f3b; --bg2:#111a87; --ring:#3e47f1; --ring2:#7f4dff;
  --card:#fff;   --text:#ffffff; --ink:#1e2240; --muted:#8087a4;

  position: relative;
  border-radius: 28px;
  overflow: hidden;
  padding: clamp(18px, 2vw, 24px);
  color: var(--text);
  margin-top: 32px;
  background:
    radial-gradient(1200px 400px at 15% 10%, rgba(126,82,255,.15), transparent 60%),
    radial-gradient(1000px 600px at 85% 90%, rgba(51,128,255,.18), transparent 60%),
    linear-gradient(135deg, var(--bg2) 0%, var(--bg1) 55%);
  box-shadow: 0 8px 40px rgba(12,18,63,.18);
}
.lead-inner{
  display: grid;
  grid-template-columns: 1fr minmax(300px, 360px);
  gap: clamp(16px, 2vw, 24px);
  align-items: center;
}
.lead-copy{
  padding: clamp(6px,1vw,8px) clamp(2px,1vw,4px);
  max-width: 760px;
}
.lead-h{
  font: 800 clamp(24px, 2.6vw, 36px)/1.2 "Commissioner", system-ui, -apple-system, Segoe UI, Roboto, Arial;
  margin: 0 0 .6rem;
  letter-spacing: -0.2px;
}
.lead-sub{
  font: 400 clamp(14px, 1vw, 16px)/1.55 "Commissioner", system-ui;
  color: rgba(255,255,255,.9);
  margin: .4rem 0 0;
  max-width: 56ch;
}

/* біла картка з формою */
.lead-form{
  position: relative;           /* поверх декорацій */
  z-index: 2;
  background: var(--card);
  color: var(--ink);
  border-radius: 18px;
  padding: clamp(12px, 1.6vw, 16px);
  box-shadow: 0 10px 40px rgba(8,10,40,.25);
  display: grid;
  gap: 10px;
}
.lead-form .field{ display:grid; gap:6px; }
.lead-form .field > span{
  font-size: 13px; color: var(--muted); letter-spacing:.2px;
}
.lead-form input,
.lead-form select{
  width: 100%;
  height: 46px;
  border-radius: 12px;
  border: 1px solid #e5e8f1;
  padding: 0 14px;
  font: 500 15px/1.2 "Commissioner", system-ui;
  color: var(--ink);
  background:#fff;
  outline: none;
  transition: border-color .15s, box-shadow .15s, background-color .2s;
}
.lead-form input::placeholder{ color:#b1b7cd; }
.lead-form input:focus,
.lead-form select:focus{
  border-color: var(--ring);
  box-shadow: 0 0 0 3px rgba(87,97,255,.18), 0 1px 0 rgba(11,22,75,.05) inset;
}
.select{ position: relative; }
.select .chev{
  width:18px; height:18px;
  position:absolute; right:12px; top:50%; transform:translateY(-50%);
  color:#9aa0b8; pointer-events:none;
}

/* кнопка */
.lead-btn{
  margin-top: 6px;
  height: 48px;
  border: none;
  cursor: pointer;
  border-radius: 12px;
  color:#fff;
  font: 700 15px/1 "Commissioner", system-ui;
  background:
    radial-gradient(120% 120% at 90% -20%, var(--ring2), transparent 60%),
    linear-gradient(90deg, #3c47ff 0%, #763bff 100%);
  box-shadow: 0 8px 20px rgba(60,71,255,.35), inset 0 0 0 1px rgba(255,255,255,.08);
  transition: transform .04s ease, box-shadow .15s ease, filter .15s ease;
}
.lead-btn:active{ transform: translateY(1px); filter: saturate(1.05); }

/* декорації */
.lead-robot{
  position: absolute;
  right: clamp(8px, 1.5vw, 16px);
  bottom: clamp(-6px, -0.5vw, 2px);
  width: min(220px, 22vw);        /* зменшили, щоб не накривати форму */
  max-width: 320px;
  z-index: 1;                     /* нижче за форму */
  pointer-events: none;
  user-select: none;
  opacity: .96;
}
.lead-spark{
  position:absolute; width:min(80px,9vw);
  pointer-events:none; user-select:none; opacity:.8;
}
.lead-spark--1{ left: clamp(18px,3vw,28px); bottom: clamp(36px,6vw,72px); }
.lead-spark--2{ left: clamp(64px,9vw,120px); bottom: clamp(84px,12vw,160px); }

/* loader */
.logading-box{
  position: absolute; inset: 0;
  display: none; place-items:center; gap:10px;
  background: rgba(13,16,52,.28);
  color:#fff; font-weight:600;
}
.logading-box__active{ display:grid !important; }
.spinner{
  width:22px; height:22px; border-radius:50%;
  border:3px solid rgba(255,255,255,.3);
  border-top-color:#fff;
  animation: spin .9s linear infinite;
}
@keyframes spin{ to{ transform: rotate(1turn) } }

/* адаптив */
@media (max-width: 1180px){
  .lead-inner{ grid-template-columns: 1fr minmax(280px, 340px); }
  .lead-robot{ width: min(200px, 24vw); }
}
@media (max-width: 980px){
  .lead-inner{ grid-template-columns: 1fr; }
  .lead-h{ font-size: clamp(22px, 6vw, 28px); }
  .lead-sub{ font-size: clamp(14px, 3.6vw, 15px); }
  .lead-robot{ display: none; }
  .lead-spark{ display: none; }
}



/* loading overlay per your class names */
.logading-box{
  position: fixed; inset: 0; display: none;
  align-items: center; justify-content: center; gap: 12px;
  background: rgba(0,0,0,.35); color: #fff; z-index: 9999;
  font-weight: 700;
}
.logading-box__active{ display: flex; }
.logading-box .spinner{
  width: 22px; height: 22px; border-radius: 50%;
  border: 3px solid rgba(255,255,255,.35);
  border-top-color: #fff; animation: spin .9s linear infinite;
}
@keyframes spin{ to { transform: rotate(360deg); } }

/* ховаємо Stage на екрані результатів */
body.results-mode #STAGE,
body.results-mode .stage{
  display: none !important;
  min-height: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* ORDER (sequence) -------------------------------------------------- */
.order-list{
  list-style:none; margin:14px 0 0; padding:0;
  display:flex; flex-direction:column; gap:10px;
}
.order-item{
  display:grid; grid-template-columns: 36px 1fr; gap:10px; align-items:center;
  padding:10px; border:1px solid var(--stroke); border-radius: var(--radius-md);
  background: var(--surface); box-shadow: var(--shadow-1);
}
.order-item.dragging{ opacity:.6; }
.drag-handle{
  display:grid; place-items:center; width:36px; height:36px;
  border-radius:10px; background: var(--primary-10); color: var(--primary);
  font-weight:700; cursor: move; user-select:none;
}
.order-text{ line-height:1.45; }

/* ================= FLEX overrides (desktop / tablet / mobile) ================= */
/* брейкпоінти для зручності — можна підкрутити під свій макет */
:root{
  --bp-desktop: 1200px;
  --bp-tablet: 900px;
  --bp-mobile: 600px;
}

/* 1) Головна: картки предметів */
.subject-grid{
  /* було: grid; стало: flex для «блочної» адаптивності */
  display: flex;
  flex-wrap: wrap;
  gap: 18px;
}
.subject-card{
  /* 4 в ряд на великих, але стискається плавно */
  flex: 1 1 calc(25% - 18px);
  min-width: 240px; /* щоб не стискалось занадто */
}
@media (max-width: 1100px){
  .subject-card{ flex-basis: calc(33.333% - 18px); } /* 3 в ряд */
}
@media (max-width: 900px){
  .subject-card{ flex-basis: calc(50% - 18px); }     /* 2 в ряд (планшет) */
}
@media (max-width: 520px){
  .subject-card{ flex-basis: 100%; }                  /* 1 в ряд (мобільний) */
}

/* 2) Завдання «Відповідність»: дві колонки */
.match-two-cols{
  /* було: grid на 2 колонки; стало: flex + wrap */
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  margin-top: 14px; /* зберігаємо відступ як у тебе */
}
.match-col{
  /* еластична ширина колонок */
  flex: 1 1 360px;        /* мінімум ~360px, далі тягнуться порівну */
}

/* матриця: не дозволяємо ламати вьюпорт, даємо горизонтальний скрол за потреби */
.match-matrix-wrap{ overflow-x: auto; }
.match-matrix{ min-width: 520px; }

/* 3) Лід-форма внизу результатів: flex-решітка */
.lead-wrap .grid{
  /* було: grid; стало: flex для чистого flex-стеку */
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}
.lead-form .field{
  flex: 1 1 260px;
  min-width: 220px;
}

/* 4) Контрол-и та шапка: акуратне перенесення на малих екранах */
.controls{ flex-wrap: wrap; }
.controls .gap{ flex: 1 1 auto; }

.header-row{ flex-wrap: wrap; }
@media (max-width: 520px){
  .header-info{
    width: 100%;
    justify-content: space-between;
    margin-left: 0;
    padding-top: 6px;
  }
}

/* ===== SIM: mobile header polish (CSS-only) ===== */

/* робимо хедер липким і без артефактів під «чубчиком» iOS */
#HEADER{
  position: sticky;
  top: 0;
  z-index: 50;
  background: var(--surface, #fff);
  backdrop-filter: saturate(1.1) blur(6px);
  border-bottom: 1px solid rgba(9,30,66,.06);
  padding-top: env(safe-area-inset-top);
}

/* базове вирівнювання */
#HEADER .header-row{
  display: flex;
  align-items: center;
  gap: 10px;
}

/* прогрес-бар під хедером — тонкий та непомітний */
.progress{ height: 3px; border-radius: 0; }

/* ——— мобільний режим ——— */
@media (max-width: 520px){
  /* кладемо блоки у 2 рядки: 1) кнопка Назад + бейдж; 2) лічильник + таймер */
  #HEADER .header-row{ flex-wrap: wrap; padding: 8px 12px; gap: 8px; }

  /* кнопка «Назад» (перший елемент у хедері) — кругла, зручна для тапу */
  #HEADER .header-row > *:first-child{
    width: 36px; height: 36px;
    display: inline-flex; align-items: center; justify-content: center;
    border-radius: 12px;
    box-shadow: 0 1px 2px rgba(9,30,66,.06);
    padding: 0;
  }

  /* бейдж предмету — помітний, але компактний */
  #SUBJECT_BADGE{
    font-weight: 700;
    font-size: 14px;
    line-height: 1;
    padding: 8px 12px;
    border-radius: 14px;
    max-width: 60vw;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    /* вирівнюємо в перший рядок поруч із «Назад» */
    order: 1;
  }

  /* група з лічильником і таймером — на весь другий рядок, справа-наліво */
  .header-info{
    order: 2;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between; /* Питання X/Y ліворуч, час праворуч */
    margin-left: 0;
    padding-top: 4px;
  }

  #COUNTER{
    font-size: 12px;
    font-weight: 600;
    color: #1f2a44;
  }
  #TIMER{
    font-size: 12px;
    font-variant-numeric: tabular-nums;
    opacity: .75;
  }

  /* додатково: прибираємо зайві відступи у контейнера з прогресом на мобільному */
  .progress-wrap{ margin-top: 0; }
}

/* трохи компактніше на середніх екранах */
@media (min-width: 521px) and (max-width: 900px){
  #HEADER .header-row{ padding: 10px 16px; }
  #SUBJECT_BADGE{ font-size: 15px; padding: 8px 14px; }
  #COUNTER, #TIMER{ font-size: 13px; }
}
/* === MathJax в межах картки, без горизонтальної прокрутки === */
.q-card .q-body mjx-container{
  max-width: 100%;
  overflow-x: hidden;       /* ні за яких умов не тягнемо скрол */
  display: block;
}

/* SVG-рендер MathJax не ширший за контейнер */
.q-card .q-body mjx-container[jax="SVG"] svg{
  max-width: 100% !important;
  height: auto;             /* пропорційне зменшення */
}

/* трішки менший розмір шрифту на вузьких телефонах */
@media (max-width: 420px){
  .q-card .q-body mjx-container{ font-size: 0.96em; }
}
@media (max-width: 360px){
  .q-card .q-body mjx-container{ font-size: 0.92em; }
}

/* запасний варіант: якщо хтось вставив довжелезний текст усередині */
.q-card .q-body{ overflow-wrap: anywhere; }

/* ==== MATCH: матриця відповіді без горизонтального скролу ==== */
.match-matrix-wrap{
  overflow: hidden;                 /* прибираємо скрол */
  position: relative;
}

.match-matrix{
  width: 100%;
  table-layout: fixed;              /* рівномірний розподіл колонок */
  border-collapse: separate;
  min-width: 0 !important;          /* перекриває попередній min-width */
}

/* компактніші комірки */
.match-matrix th,
.match-matrix td{ padding: 6px; }
.match-matrix .row-head,
.match-matrix .col-head{ font-size: 12px; }

/* розмір “чіпс” у клітинці */
.match-matrix .cell-label{
  width: 22px; height: 22px; border-radius: 8px;
}

/* ще компактніше на вузьких екранах */
@media (max-width: 420px){
  .match-matrix th,
  .match-matrix td{ padding: 4px; }
  .match-matrix .cell-label{ width: 20px; height: 20px; border-radius: 7px; }
  .match-matrix .row-head,
  .match-matrix .col-head{ font-size: 11px; }
}
/* ===== MATCH matrix — full width on desktop ===== */
.q-card .match-matrix-wrap{
  width: 100% !important;
  overflow: visible !important;   /* знімаємо старий auto-скрол */
}

.q-card .match-matrix{
  width: 100% !important;
  min-width: 0 !important;        /* прибиваємо старі 520px */
  table-layout: fixed;            /* рівні колонки */
}

/* компактні падінги, щоб умістилось більше колонок */
.q-card .match-matrix th,
.q-card .match-matrix td{ padding: 8px 10px; }

/* великі екрани — трішки вільніше */
@media (min-width: 1024px){
  .q-card .match-matrix th,
  .q-card .match-matrix td{ padding: 10px 12px; }
}

/* мобільний — залишаємо компактні розміри (разом із fitMatrix у JS) */
@media (max-width: 480px){
  .q-card .match-matrix th,
  .q-card .match-matrix td{ padding: 6px 8px; }
  .q-card .match-matrix .cell-label{ width: 20px; height: 20px; border-radius: 7px; }
}
/* Більше «повітря» навколо матриці відповідей */
.match-matrix-wrap{
  margin: 16px 0 24px; /* top / bottom */
}

.matrix-title{
  margin-bottom: 10px;
}

/* трохи компактніше на вузьких екранах */
@media (max-width: 520px){
  .match-matrix-wrap{ margin: 12px 0 20px; }
  .matrix-title{ margin-bottom: 8px; }
}
/* Ховаємо спінери у всіх числових інпутів всередині картки */
.q-card input[type="number"] {
  appearance: textfield;
  -moz-appearance: textfield;
}

.q-card input[type="number"]::-webkit-outer-spin-button,
.q-card input[type="number"]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* ховаємо спінери у всіх number-полях */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button{
  -webkit-appearance: none;
  margin: 0;
}
input[type="number"]{
  -moz-appearance: textfield; /* Firefox */
  appearance: textfield;
}
/* ===== CLEAN RESET: MathJax + Match matrix (append at end) ===== */

/* 1) MathJax: інлайнова формула лишається inline */
.q-card .q-body mjx-container{
  display: inline;
  max-width: 100%;
  overflow: visible;          /* без локальних скролів і «стрілочок» */
  vertical-align: middle;
  line-height: 1.2;
  margin: 0 .12em;
}
/* а тільки display-формули — блокові */
.q-card .q-body mjx-container[display="true"]{
  display: block;
  text-align: left;
  margin: .35rem 0 .55rem;
}
/* SVG MathJax ніколи не ширший за контейнер */
.q-card .q-body mjx-container[jax="SVG"] svg{
  max-width: 100% !important;
  height: auto;
}
/* на дуже вузьких екранах трохи зменшуємо формули */
@media (max-width: 420px){ .q-card .q-body mjx-container{ font-size: .96em; } }
@media (max-width: 360px){ .q-card .q-body mjx-container{ font-size: .92em; } }

/* 2) MATCH matrix: єдине джерело правди */
.match-matrix-wrap{
  margin: 16px 0 24px;
  overflow: visible;          /* прибити усі попередні overflow для стабільної висоти */
  height: auto !important;
}
.match-matrix{
  width: 100% !important;
  min-width: 0 !important;    /* прибиваємо старі min-width */
  table-layout: fixed;
  border-collapse: separate;
  border-spacing: 6px;
}
.match-matrix th, .match-matrix td{ padding: 8px; }
.match-matrix .cell{ height: 42px; }
.match-matrix .cell-label{ width: 24px; height: 24px; border-radius: 8px; }
/* мобільні — компактніше */
@media (max-width: 520px){
  .match-matrix th, .match-matrix td{ padding: 6px; }
  .match-matrix .cell-label{ width: 20px; height: 20px; border-radius: 7px; }
}

/* 3) Про всяк випадок: ховаємо спінери number-полів */
.q-card input[type="number"]{
  appearance: textfield; -moz-appearance: textfield;
}
.q-card input[type="number"]::-webkit-outer-spin-button,
.q-card input[type="number"]::-webkit-inner-spin-button{
  -webkit-appearance: none; margin: 0;
}
/* =========================
   RESULTS — mobile fixes
   ========================= */

/* 1) Верхній бар результатів (назва + кнопка) */
.sim-top, .results-top, .page-top, .app-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  flex-wrap: wrap;
  min-height: 44px;
}
.sim-top .brand, .results-top .brand, .page-top .brand, .app-top .brand {
  min-width: 0;
  display: flex;
  flex-direction: column;
  line-height: 1.05;
  font-weight: 700;
}
.sim-top .brand small,
.results-top .brand small,
.page-top .brand small,
.app-top .brand small {
  font-weight: 400;
  opacity: .7;
}

/* кнопка "На головну" — не переносити, менше падингу на мобілі */
.sim-top .to-home, .results-top .to-home, .page-top .to-home, .app-top .to-home,
.sim-top a.btn-home, .results-top a.btn-home {
  white-space: nowrap;
  padding: 8px 12px;
  font-size: 14px;
  line-height: 1;
}

/* 2) Карта з «попереднім результатом» — трохи щільніше на мобілі */
#RESULTS .score-card, #RESULTS .result-card {
  padding: clamp(12px, 3.5vw, 18px);
}

/* 3) Таблиці в акордеонах (за темами/навичками) */
#RESULTS details > div table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
}

/* desktop — як було, але підрівняємо мін-ширини для чисел */
#RESULTS details > div table td.number,
#RESULTS details > div table th.number {
  min-width: 56px;
  text-align: right;
}

/* MOBILE: робимо рядки-картки */
@media (max-width: 560px){
  #RESULTS details > div table thead { display: none; }
  #RESULTS details > div table tbody,
  #RESULTS details > div table tr,
  #RESULTS details > div table td,
  #RESULTS details > div table th { display: block; }

  #RESULTS details > div table tr {
    background: #f8f9fd;
    border: 1px solid #eef1f6;
    border-radius: 12px;
    padding: 10px 12px;
    margin-bottom: 10px;
  }

  /* сітка всередині рядка: назва/прогрес на всю ширину, далі 2 числа праворуч */
  #RESULTS details > div table tr{
    display: grid;
    grid-template-columns: 1fr auto auto;
    grid-auto-rows: auto;
    column-gap: 10px;
    row-gap: 6px;
    align-items: center;
  }

  /* перша клітинка (назва) на всю ширину */
  #RESULTS details > div table td:first-child,
  #RESULTS details > div table th:first-child{
    grid-column: 1 / -1;
    font-weight: 600;
    color: #1e2240;
    margin-bottom: 2px;
  }

  /* прогрес (якщо є) — теж на всю ширину під назвою */
  #RESULTS .progress-wrap,
  #RESULTS .stat-progress {
    grid-column: 1 / -1;
    width: 100%;
  }

  /* числа "Завдань"/"Правильних" */
  #RESULTS details > div table td.number{
    justify-self: end;
    font-variant-numeric: tabular-nums;
    font-weight: 700;
    background: #eaf7ee;
    color: #0a7a37;
    padding: 6px 10px;
    border-radius: 10px;
  }
  /* лівіше число (кількість завдань) — спокійніший фон */
  #RESULTS details > div table td.number.tasks{
    background: #eef1f6;
    color: #1e2240;
  }
}

/* 4) Дрібні типографічні підрізки на вузьких екранах */
@media (max-width: 560px){
  #RESULTS h1, #RESULTS h2, #RESULTS h3{
    font-size: clamp(18px, 5.2vw, 22px);
    line-height: 1.2;
  }
  #RESULTS .muted, #RESULTS .note{
    font-size: 13px;
  }
}

/* 5) Фікс для круглої "0%" таблетки всередині прогреса, щоб не ламала рядок */
#RESULTS .pill, #RESULTS .badge {
  white-space: nowrap;
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 999px;
}
/* ===== RESULTS: Summary tables -> mobile cards ===== */

/* Базове вирівнювання на десктопі (звужує числові колонки) */
#RESULTS table { width: 100%; border-collapse: separate; border-spacing: 0; }
#RESULTS table th, #RESULTS table td { padding: 10px 12px; }
#RESULTS table th:nth-child(2),
#RESULTS table td:nth-child(2),
#RESULTS table th:nth-child(3),
#RESULTS table td:nth-child(3),
#RESULTS table th:nth-child(4),
#RESULTS table td:nth-child(4){
  min-width: 64px;
  text-align: center;
  white-space: nowrap;
  font-variant-numeric: tabular-nums;
}

/* Спробуємо не зачепити інші таблиці: звужуємося до summary/accordion-зон */
#RESULTS details table,
#RESULTS .summary table,
#RESULTS .stats table{
  width: 100%;
}

/* MOBILE: перетворюємо рядки в “картки” */
@media (max-width: 560px){

  /* Тільки для підсумкових таблиць (всередині details/summary/статистики) */
  #RESULTS details table thead,
  #RESULTS .summary table thead,
  #RESULTS .stats table thead{ display: none; }

  #RESULTS details table tbody,
  #RESULTS .summary table tbody,
  #RESULTS .stats table tbody{ display: grid; gap: 10px; }

  #RESULTS details table tr,
  #RESULTS .summary table tr,
  #RESULTS .stats table tr{
    display: grid;
    grid-template-columns: 1fr auto auto; /* назва | 2 числові */
    align-items: center;
    column-gap: 10px;
    row-gap: 6px;

    background: #f8f9fd;
    border: 1px solid #eef1f6;
    border-radius: 12px;
    padding: 10px 12px;
  }

  /* Назва теми/навички на всю ширину */
  #RESULTS details table td:first-child,
  #RESULTS .summary table td:first-child,
  #RESULTS .stats table td:first-child{
    grid-column: 1 / -1;
    padding: 0;
    font-weight: 600;
    color: #1e2240;
  }

  /* “Завдань” — проста пігулка */
  #RESULTS details table td:nth-child(2),
  #RESULTS .summary table td:nth-child(2),
  #RESULTS .stats table td:nth-child(2){
    justify-self: end;
    padding: 6px 10px;
    border-radius: 10px;
    background: #eef1f6;
    color: #1e2240;
    min-width: 42px;
  }

  /* “Правильних” — зелена пігулка */
  #RESULTS details table td:nth-child(3),
  #RESULTS .summary table td:nth-child(3),
  #RESULTS .stats table td:nth-child(3){
    justify-self: end;
    padding: 6px 10px;
    border-radius: 10px;
    background: #eaf7ee;
    color: #0a7a37;
    min-width: 42px;
  }

  /* “Неправильних” — рожева пігулка */
  #RESULTS details table td:nth-child(4),
  #RESULTS .summary table td:nth-child(4),
  #RESULTS .stats table td:nth-child(4){
    justify-self: end;
    padding: 6px 10px;
    border-radius: 10px;
    background: #fdecec;
    color: #c52c2c;
    min-width: 42px;
  }

  /* Трохи компактніші заголовки/сабтайтли в блоці результатів */
  #RESULTS h2, #RESULTS h3{
    font-size: clamp(18px, 5.2vw, 22px);
    line-height: 1.2;
  }
  #RESULTS .muted, #RESULTS .note{ font-size: 13px; }
}

/* Дрібне полірування десктопу: числа вирівнюємо і зменшуємо падінги */
@media (min-width: 561px){
  #RESULTS details table td:nth-child(2),
  #RESULTS details table td:nth-child(3),
  #RESULTS details table td:nth-child(4),
  #RESULTS .summary table td:nth-child(2),
  #RESULTS .summary table td:nth-child(3),
  #RESULTS .summary table td:nth-child(4),
  #RESULTS .stats table td:nth-child(2),
  #RESULTS .stats table td:nth-child(3),
  #RESULTS .stats table td:nth-child(4){
    padding: 8px 10px;
  }
}
/* =========================
   RESULTS — MOBILE: таблиці -> картки
   (працює для ВСІХ таблиць усередині #RESULTS)
   ========================= */
@media (max-width: 600px){
  /* ховаємо шапку, все інше перетворюємо на grid-картки */
  #RESULTS table thead{ display:none !important; }

  #RESULTS table,
  #RESULTS table tbody{ display:block !important; }
  #RESULTS table tr{
    display:grid !important;
    grid-template-columns: 1fr auto auto;   /* Назва | 2 числа */
    gap: 6px 10px;
    align-items:center;

    background:#f8f9fd;
    border:1px solid #eef1f6;
    border-radius:12px;
    padding:10px 12px;
    margin-bottom:10px;
  }

  /* Назва теми/навички на всю ширину зверху */
  #RESULTS table td:first-child{
    grid-column: 1 / -1;
    padding:0 !important;
    font-weight:600;
    color:#1e2240;
  }

  /* прогрес-бар (якщо є в назві) теж на всю ширину */
  #RESULTS .progress-wrap,
  #RESULTS .stat-progress{ grid-column:1 / -1; width:100%; }

  /* “Завдань” — сіра пігулка */
  #RESULTS table td:nth-child(2){
    justify-self:end;
    padding:6px 10px !important;
    border-radius:10px;
    min-width:42px;
    background:#eef1f6;
    color:#1e2240;
    font-weight:700;
    font-variant-numeric: tabular-nums;
  }
  /* “Правильних” — зелена пігулка */
  #RESULTS table td:nth-child(3){
    justify-self:end;
    padding:6px 10px !important;
    border-radius:10px;
    min-width:42px;
    background:#eaf7ee;
    color:#0a7a37;
    font-weight:700;
    font-variant-numeric: tabular-nums;
  }
  /* “Неправильних” — червона пігулка */
  #RESULTS table td:nth-child(4){
    justify-self:end;
    padding:6px 10px !important;
    border-radius:10px;
    min-width:42px;
    background:#fdecec;
    color:#c52c2c;
    font-weight:700;
    font-variant-numeric: tabular-nums;
  }
}

/* =========================
   RESULTS — DESKTOP: відступ між зеленою/червоною колонками
   ========================= */
@media (min-width: 601px){
  /* роз’єднуємо колонки по горизонталі */
  #RESULTS table{
    border-collapse: separate !important;
    border-spacing: 8px 0 !important;     /* горизонтальний gap */
    background-clip: padding-box;
  }
  /* щоб колір не «затікав» у пробіл */
  #RESULTS table th, #RESULTS table td{ background-clip: padding-box; }

  /* округлення і падинги для кольорових клітинок */
  #RESULTS table td:nth-child(3),
  #RESULTS table td:nth-child(4){
    border-radius:12px;
    padding:10px 12px;
    font-variant-numeric: tabular-nums;
    text-align:center;
    font-weight:700;
  }
  /* якщо у тебе власні фони — не чіпаю; інакше додамо дефолтні */
  #RESULTS table td:nth-child(3){ background:#eaf7ee; color:#0a7a37; }
  #RESULTS table td:nth-child(4){ background:#fdecec; color:#c52c2c; }
}
